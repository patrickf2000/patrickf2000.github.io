<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Patrick Flynn's Website | Lila Compiler Development</title>
    <link rel="shortcut icon" type="image/png" href="/favicon.png">
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    <link rel="stylesheet" href="/theme/css/screen.css" type="text/css" />
    <link rel="stylesheet" href="/theme/css/pygments.css" type="text/css" />
    <link rel="stylesheet" href="/theme/css/print.css" type="text/css" media="print" />
    <meta name="generator" content="Pelican" />
    <meta name="description" content="" />
    <meta name="author" content="Patrick Flynn" />
</head>
<body>
    <header>
        <nav>
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/pages/contact-me.html">Contact Me</a></li>
                <li><a href="https://github.com/patrickf2000">GitHub</a></li>
                <li><a href="/blog_index.html">Blog</a></li>
                <li><a href="/categories">Categories</a></li>
            </ul>
        </nav>
        <div class="header_box">
            <h1><a href="/">Patrick Flynn's Website</a></h1>
        </div>
    </header>
    <div id="wrapper">
        <div id="content">
            <div class="page">
                <h1>Lila Compiler Development</h1>
                <p>The development logs for my Lila compiler and language.</p>
<h3>12/16/2020</h3>
<p>Yet another big day. I ended up more or less taking the day other than a meeting; its been an exhausting semester. It may sound weird to some, but these projects are actually a really good way for me to deal with burn out.</p>
<p>I got a huge amount of RISC-V work done. All the integer, short, and byte tests now pass. The arrays took the longest to get working; the alignment and stack layout for RISC-V is a little weird. x86 and Arm both start at the top- but not literally, the first variables location in relation to the base pointer is the stack size minus the base pointer (in other words, if your stack is of size 24 and your variable is 4 long, it would start at 20 or 4- 20 if on Arm, 4 if on x86). On RISC-V, this holds true except for 8 byte variables. If the stack starts at 24, the first variable starts at 24. I'm planning on writing some posts on RISC-V, maybe tomorrow.</p>
<p>In the process of doing this work, I spent the majority of the time in the RISC-V emulator. Its a little annoyingly slow, but its not prohibitive. Fortunately, once you get the hang of Rust, you can do a pretty fair amount of work in between compiling and count on everything working. Especially on the LTAC layer where its pretty much just a 1:1 translation between the IR and the final assembly. The pain point is when I have to run the tests. They take about 10 minutes to fully run (at this point, I'm up to like 120 of the 188 or so).</p>
<p>Most of the new code is in the development branch now.</p>
<h3>12/15/2020</h3>
<p>Today was kind of a big day. I got a fair amount of RISC-V work done. Okay, maybe not huge... Very few of the integer tests pass. But still, code generation for all the signed int-32 math and logical operations are now supported. I am excited though; RISC-V is a new architecture for me.</p>
<p>RISC-V is very interesting. In a lot of ways, its similar to Arm, but in some ways its completed different. Arm is like x86 in that it uses the same instructions for all sizes; you just change the registers based on your needs. RISC-V takes the opposite approach; separate instructions for each size, but always the same registers. This actually makes things a little easier in some ways. RISC-V is interesting though when it comes to immediates. I'll write a post on this later.</p>
<h3>12/14/2020</h3>
<p>I did manage to squeeze in a few hours later in the day and this evening (I'm still working a little as I write this). I decided to get started on the different CPU architecture ports. I definitely want to target Arm64 and RISC-V and maybe MIPS. I did get some of the initial code working for the Arm64 port; basically, the backend is all set up, and it generate assembly for and compile hello world and a few very simple programs.</p>
<p>I also laid the base for the RISC-V backend and got the Hello World program working. RISC architectures are fairly similar, so I think once I have one in place, adding others will be fairly straightforward. I debated on how to approach doing these backends, and I'm thinking for all the RISC ones at least, I'm going to get all the basic backends in place, then break down the work in sections. So basically, let's say I do a set of operations on Arm; I will get that working, then move on and do the same thing on the other architectures. That way, they will all be more or less at the same pace.</p>
<p>For the curious, I'm using Qemu emulators to do development. My Arm64 emulator actually works quite well; its running Ubuntu 20, which helps with the linking paths. I just started with RISC-V and it seems pretty slow. Hopefully its usable, but at first glance, it took a long to build. Its running Fedora 33.</p>
<h3>12/13/2020</h3>
<p>Not much today. I started on a very rough draft for a standard library.</p>
<p>Basically, here's the idea. Originally, I was going to make a standard library a more or less optional thing- my idea wasn't to confine the language to a standard other than the language itself. I'm thinking I may change my stance on that. Programming will become a <em>nightmare</em> if the user has to deal with different APIs on every platform, or even the same platform if they want to use the C library vs the Lila library. My solution to that is create a set of standards that any Lila program can use. To the program itself, it won't matter what library, API, or platform they are on; the user can compile and link however they want. In the case of the C library, the function calls will be to equivalent C functions. Maybe eventually I can implement inlining to eliminate function call overheads. Or maybe explicit inlining- that's an idea. Otherwise, the calls may be pure Lila functions, or even something else.</p>
<p>This week is the last week of school, so I'm not sure how much time I'll have to develop this. But I'll post if I do either decide on something or do it.</p>
<h3>12/12/2020</h3>
<p>Originally, this project was named "Dash". A friend came up with the name, and I really really like it, but I decided to change it for a few reasons. First, I think I tried releasing it too early. Its pretty complete, and can do a few non-trival things, but I should not have posted on it as early as I did. That said, I am glad that I made it open source when I did. The second reason is that I'm thinking about some non-trivial syntax changes (mainly inspired by Pascal and Ada), so if I change it enough, it really needs to be something different. The final reason kind of builds onto the second. The name Dash is somewhat similar to Quik, which is partly why I went with it. However, I feel like it gives an impression of something the language is not, and if I change it enough, I won't be similar to Quik.</p>
<p>I also decided to drop my work with porting it to my custom assembler. That is still a long-term goal, but my current assembler is kind of a mess and not really that stable. I have the base of new one written in Ada in storage so to speak, so when I resume work on that, and if it works out, I will probably port it to that. I also dropped the work because I really wanted to get started with other architectures.</p>
<p>That said, the work and everything wasn't all wasted. I created two branches for the original Dash stable branch and the last state of the development branch before the rename. I created new development and stable branches and renamed everything. I also updated all the documentation.</p>
            </div>

            <div class="clear"></div>
            <footer>
                <p>
                <a href="https://github.com/jody-frankowski/blue-penguin">Blue Penguin</a> Theme
                &middot;
                Powered by <a href="http://getpelican.com">Pelican</a>
            </footer>
        </div>
        <div class="clear"></div>
    </div>
    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-213498014-7");
    pageTracker._trackPageview();
    } catch(err) {}</script>
</body>
</html>